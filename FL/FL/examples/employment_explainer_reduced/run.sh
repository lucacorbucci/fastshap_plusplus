# # employment_explainer_50_nodes_non_iid_DP_BB
# #poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=311 --eff_lambda=0.6620819360571745 --epochs=5 --lr=0.00252090473795934 --num_samples=26 --optimizer=sgd --paired_sampling=False --validation_samples=38 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --split_approach non_iid --alpha_dirichlet 5 --train_explainer True --surrogate_name ./surrogate_DP_1.pth --splitted_data_dir federated  --save_aggregated_model True --aggregated_model_name explainer_NO_DP
# poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=480 --eff_lambda=0.5904372449478531 --epochs=10 --lr=0.014041599407228406 --num_samples=20 --optimizer=adam --paired_sampling=True --validation_samples=46 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --split_approach non_iid --alpha_dirichlet 5 --train_explainer True --surrogate_name ./surrogate_DP_1.pth --splitted_data_dir federated_2 --save_aggregated_model True --aggregated_model_name explainer_NO_DP_new --save_aggregated_model True --aggregated_model_name explainer_NO_DP_new
# poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=259 --eff_lambda=0.49142972682570973 --epochs=10 --lr=0.004154263714950108 --num_samples=18 --optimizer=sgd --paired_sampling=False --validation_samples=47 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --split_approach non_iid --alpha_dirichlet 5 --train_explainer True --surrogate_name ./surrogate_DP_1.pth --splitted_data_dir federated  --save_aggregated_model True --aggregated_model_name explainer_NO_DP_minimum
# employment_explainer_50_nodes_non_iid_DP_01_DP_BB
# poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=292 --clipping=1.1198935332783555 --eff_lambda=0.3956308676147763 --epochs=6 --lr=0.01420059457787651 --num_samples=48 --optimizer=sgd --paired_sampling=True --validation_samples=31 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --alpha_dirichlet 5 --train_explainer True --surrogate_name ./surrogate_DP_1.pth --epsilon 0.1 --splitted_data_dir federated_2 --save_aggregated_model True --aggregated_model_name explainer_DP_01
# poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=405 --clipping=1.604352184751085 --eff_lambda=0.3429097570425478 --epochs=10 --lr=0.016799998699763948 --num_samples=37 --optimizer=sgd --paired_sampling=True --validation_samples=22 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --alpha_dirichlet 5 --train_explainer True --surrogate_name ./surrogate_DP_1.pth --epsilon 0.1 --splitted_data_dir federated_2 --save_aggregated_model True --aggregated_model_name explainer_DP_01_new
# poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=427 --clipping=1.6452785562110614 --eff_lambda=0.7143054746519428 --epochs=5 --lr=0.0033905791282032903 --num_samples=37 --optimizer=sgd --paired_sampling=True --validation_samples=26 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --alpha_dirichlet 5 --train_explainer True --surrogate_name ./surrogate_DP_1.pth --epsilon 0.1 --splitted_data_dir federated_2  --save_aggregated_model True --aggregated_model_name explainer_DP_01_new

# # employment_explainer_50_nodes_non_iid_DP_05_DP_BB
# # poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=440 --clipping=1.0047948488293907 --eff_lambda=0.0445266123279171 --epochs=10 --lr=0.02657676911755479 --num_samples=26 --optimizer=sgd --paired_sampling=False --validation_samples=28 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --split_approach non_iid --alpha_dirichlet 5 --train_explainer True --surrogate_name ./surrogate_DP_1.pth --epsilon 0.5 --save_aggregated_model True --aggregated_model_name explainer_DP_05
# poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=470 --clipping=6.112917187490186 --eff_lambda=0.5602058639530085 --epochs=10 --lr=0.013162611257405834 --num_samples=30 --optimizer=sgd --paired_sampling=False --validation_samples=22 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --split_approach non_iid --alpha_dirichlet 5 --train_explainer True --surrogate_name ./surrogate_DP_1.pth --epsilon 0.5 --save_aggregated_model True --aggregated_model_name explainer_DP_05_new

# /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=388 --clipping=5.651992451641287 --eff_lambda=0.15639305533180403 --epochs=10 --lr=0.03748696119139514 --num_samples=31 --optimizer=sgd --paired_sampling=True --validation_samples=21 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.3 --sampled_validation_nodes 1 --sampled_test_nodes 0 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.6 --fraction_validation_nodes 0.2 --fraction_test_nodes 0.2 --device cuda --cross_device True --split_approach non_iid --alpha_dirichlet 5 --train_explainer True --surrogate_name ./surrogate_DP_1.pth --epsilon 0.5
# poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=470 --clipping=6.112917187490186 --eff_lambda=0.5602058639530085 --epochs=10 --lr=0.013162611257405834 --num_samples=30 --optimizer=sgd --paired_sampling=False --validation_samples=22 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --split_approach non_iid --alpha_dirichlet 5 --train_explainer True --surrogate_name ./surrogate_DP_1.pth --epsilon 0.5 --save_aggregated_model True --aggregated_model_name explainer_DP_05_16
poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=388 --clipping=5.651992451641287 --eff_lambda=0.15639305533180403 --epochs=10 --lr=0.03748696119139514 --num_samples=31 --optimizer=sgd --paired_sampling=True --validation_samples=21 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --split_approach non_iid --alpha_dirichlet 5 --train_explainer True --surrogate_name ./surrogate_DP_1.pth --epsilon 0.5 --save_aggregated_model True --aggregated_model_name explainer_DP_05_17

# # employment_explainer_50_nodes_non_iid_DP_1_DP_BB
# # poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=283 --clipping=2.586166101360625 --eff_lambda=0.16375400631673576 --epochs=10 --lr=0.03978244119280488 --num_samples=29 --optimizer=sgd --paired_sampling=False --validation_samples=43 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --split_approach non_iid --alpha_dirichlet 5 --train_explainer True --surrogate_name ./surrogate_DP_1.pth --epsilon 1 --splitted_data_dir federated_2 --save_aggregated_model True --aggregated_model_name explainer_DP_1
# poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=324 --clipping=1.578254041183662 --eff_lambda=0.3948312123752531 --epochs=9 --lr=0.04095940715468212 --num_samples=28 --optimizer=sgd --paired_sampling=False --validation_samples=35 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --split_approach non_iid --alpha_dirichlet 5 --train_explainer True --surrogate_name ./surrogate_DP_1.pth --epsilon 1 --splitted_data_dir federated_2 --save_aggregated_model True --aggregated_model_name explainer_DP_1_new

# # employment_explainer_50_nodes_non_iid_DP_2_DP_BB
# # poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=395 --clipping=5.874653273288747 --eff_lambda=0.7165205206665476 --epochs=10 --lr=0.003999506803817058 --num_samples=45 --optimizer=adam --paired_sampling=False --validation_samples=22 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --split_approach non_iid --alpha_dirichlet 5 --train_explainer True --surrogate_name ./surrogate_DP_1.pth --epsilon 2 --splitted_data_dir federated_2 --save_aggregated_model True --aggregated_model_name explainer_DP_2
# poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=282 --clipping=1.5781486350230876 --eff_lambda=0.16902733014050542 --epochs=8 --lr=0.0755612923957246 --num_samples=29 --optimizer=sgd --paired_sampling=True --validation_samples=19 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --split_approach non_iid --alpha_dirichlet 5 --train_explainer True --surrogate_name ./surrogate_DP_1.pth --epsilon 2 --splitted_data_dir federated_2 --save_aggregated_model True --aggregated_model_name explainer_DP_2_new

# # employment_explainer_50_nodes_non_iid_DP_5_DP_BB
# #poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=437 --clipping=1.8275821628620288 --eff_lambda=0.588995503263886 --epochs=6 --lr=0.004354803963472046 --num_samples=22 --optimizer=adam --paired_sampling=True --validation_samples=36 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --split_approach non_iid --alpha_dirichlet 5 --train_explainer True --surrogate_name ./surrogate_DP_1.pth --epsilon 2 --splitted_data_dir federated --save_aggregated_model True --aggregated_model_name explainer_DP_5
# poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=460 --clipping=1.8310621744304048 --eff_lambda=0.9983880106626508 --epochs=6 --lr=0.010324698264601346 --num_samples=20 --optimizer=adam --paired_sampling=False --validation_samples=36 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --split_approach non_iid --alpha_dirichlet 5 --train_explainer True --surrogate_name ./surrogate_DP_1.pth --epsilon 2 --splitted_data_dir federated --save_aggregated_model True --aggregated_model_name explainer_DP_5_new


# poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=415 --eff_lambda=0.31946529993707173 --epochs=10 --lr=0.0035324571374512254 --num_samples=36 --optimizer=sgd --paired_sampling=True --validation_samples=26 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --split_approach non_iid --alpha_dirichlet 5 --train_explainer True --surrogate_name ./employment_surrogate_NO_DP.pth --splitted_data_dir federated_3 --save_aggregated_model True --aggregated_model_name comparison_with_centralised_1

# poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=316 --eff_lambda=0.9100929992990932 --epochs=8 --lr=0.027887260242447892 --num_samples=48 --optimizer=adam --paired_sampling=False --validation_samples=26 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --split_approach non_iid --alpha_dirichlet 5 --train_explainer True --surrogate_name ./employment_surrogate_NO_DP.pth --splitted_data_dir federated_3 --save_aggregated_model True --aggregated_model_name comparison_with_centralised_2

# poetry run python /home/lcorbucci/private_fastshap/FL/FL/examples/employment_explainer_reduced/../../main.py --batch_size=496 --eff_lambda=0.3318125455433796 --epochs=7 --lr=0.0017986736486674975 --num_samples=41 --optimizer=sgd --paired_sampling=False --validation_samples=25 --dataset_name employment --fl_rounds 10 --num_client_cpus 1 --num_client_gpus 0.1 --tabular True --num_nodes 50 --sampled_training_nodes 0.225 --sampled_validation_nodes 0 --sampled_test_nodes 1 --dataset_path /raid/lcorbucci/folktables/employment_data_reduced/ --seed 42 --wandb True --split_approach non_iid --fraction_fit_nodes 0.8 --fraction_validation_nodes 0 --fraction_test_nodes 0.2 --device cuda --cross_device True --split_approach non_iid --alpha_dirichlet 5 --train_explainer True --surrogate_name ./employment_surrogate_NO_DP.pth --splitted_data_dir federated --save_aggregated_model True --aggregated_model_name comparison_with_centralised_3